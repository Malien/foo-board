var q=Object.defineProperty,L=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var O=(e,t,r)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f=(e,t)=>{for(var r in t||(t={}))z.call(t,r)&&O(e,r,t[r]);if(P)for(var r of P(t))H.call(t,r)&&O(e,r,t[r]);return e},m=(e,t)=>L(e,V(t));import{j as d,c as b,a as s,R as K,T as W,C as X,I as N,A as $,P as J,b as Y,r as g,D as G,d as j,M as Q,e as R,o as U,f as Z}from"./vendor.dfe0bf05.js";const ee=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}};ee();const te=(e,t)=>e.order-t.order;function x({kind:e,className:t}){return d("i",{className:b("material-icons",t),children:e})}const C="px-4 py-3 grid items-center [grid-template-columns:auto_1fr] gap-2 text-md relative before:absolute before:inset-0 before:bg-emerald-600 before:opacity-0 before:transition-opacity before:duration-200 cursor-pointer hover:before:opacity-15 outline-none first-of-type:before:rounded-t-xl last-of-type:before:rounded-b-xl focus:before:opacity-40 active:before:opacity-50 font-bold text-emerald-800";function re({leftBoard:e,rightBoard:t,onDelete:r,onMove:n}){return s(K,{children:[d(W,{className:"flex items-center",children:d(x,{kind:"more_horiz"})}),s(X,{loop:!0,side:"right",className:"bg-white rounded-xl overflow-hidden shadow-xl",children:[e&&s(N,{onClick:n&&(()=>n(e.id)),className:C,children:[d(x,{kind:"keyboard_double_arrow_left"}),'Move to "',e.name,'"']}),t&&s(N,{onClick:n&&(()=>n(t.id)),className:C,children:[d(x,{kind:"keyboard_double_arrow_right"}),'Move to "',t.name,'"']}),s(N,{onClick:r,className:b(C,"text-rose-600 before:bg-rose-600"),children:[d(x,{kind:"delete"}),"Delete"]}),d($,{className:"fill-white z-10 -m-[2px]",width:20,height:10})]})]})}function oe({card:e,leftBoard:t,rightBoard:r,onDelete:n,onMove:o}){return d(J,{draggableId:String(e.id),index:e.order,children:(a,i)=>{var l;return s("div",m(f(f({className:b("bg-emerald-400 rounded-md overflow-hidden shadow-sm cursor-pointer","mb-2 select-none",i.isDragging&&!i.isDropAnimating&&"opacity-60"),ref:a.innerRef},a.draggableProps),a.dragHandleProps),{style:m(f({},a.draggableProps.style),{transform:b((l=a.draggableProps.style)==null?void 0:l.transform,i.isDragging&&!i.isDropAnimating&&"rotate(4deg)")}),children:[s("div",{className:"px-2 py-1 text-white font-semibold flex  justify-between items-center",children:[e.title,d(re,{leftBoard:t,rightBoard:r,onDelete:n,onMove:o})]}),e.description&&d("div",{className:"bg-white px-2 py-1",children:e.description})]}))}})}function ae({board:e,cards:t,leftBoard:r,rightBoard:n,onDelete:o,onMove:a}){return s("div",{className:"rounded-md bg-slate-300 flex flex-col",children:[d("div",{className:"mx-2 my-1 font-medium",children:e.name}),d(Y,{droppableId:String(e.id),children:(i,l)=>s("div",m(f({className:b("h-full bg-slate-100 m-1.5 mt-0 rounded-md p-2 grid auto-rows-min",l.isDraggingOver&&"bg-emerald-50")},i.droppableProps),{ref:i.innerRef,children:[t.map(c=>d(oe,{card:c,leftBoard:r,rightBoard:n,onDelete:o&&(()=>o(c.id)),onMove:a&&(y=>a(c,y))},String(c.id))),i.placeholder]}))})]})}function ne({draggableId:e,source:t,destination:r}){if(!r)return;const n=Number.parseInt(e,10);if(Number.isNaN(n))return;const o=Number.parseInt(t.droppableId,10);if(Number.isNaN(o))return;const a=Number.parseInt(r.droppableId,10);if(!Number.isNaN(a))return{cardId:n,source:{boardId:o,order:t.index},destination:{boardId:a,order:r.index}}}function de(e,{destination:t,cardId:r,source:n}){return t.boardId===n.boardId&&t.order===n.order?e:e.map(o=>{let a=0;return o.boardId===n.boardId&&o.order>n.order&&(a-=1),o.boardId===t.boardId&&o.order+a>=t.order&&(a+=1),a===0?o:m(f({},o),{order:o.order+a})}).update(r,o=>{if(!!o)return f(f({},o),t)})}function ie(e,t){const r=[...e];return r.sort(t),r}function le(e){const t=[];for(let r=0;r<e.length;++r)t.push([e[r-1],e[r],e[r+1]]);return t}function se({boards:e,cards:t,onReorder:r,onDelete:n,onMove:o}){const a=l=>{const c=ne(l);c&&(r==null||r(c))},i=g.exports.useMemo(()=>t.groupBy(l=>l.boardId).map(l=>ie(l.values(),te)).toMap(),[t]);return d(G,{onDragEnd:a,children:d("div",{className:"p-4 grid grid-flow-col [grid-auto-columns:minmax(300px,1fr)]  gap-4 min-h-[360px] m-auto w-fit",children:le(e).map(([l,c,y])=>d(ae,{board:c,cards:i.get(c.id)||[],leftBoard:l,rightBoard:y,onDelete:n,onMove:o},String(c.id)))})})}function ce({onNewItem:e}){return d("header",{className:"bg-emerald-300 sticky top-0 left-0 right-0",children:s("div",{className:"m-auto max-w-screen-xl py-2 px-6 flex justify-between  text-2xl font-semibold items-center",children:["FooBoard",s("button",{className:"appearance-none border-none py-1 px-6 relative m-0  bg-white font-medium text-xl rounded-md cursor-pointer flex  items-center pr-8 after:absolute after:inset-0 after:opacity-0 after:rounded-md  after:transition-opacity after:ease-in after:duration-100 before:absolute before:inset-0 before:opacity-0 before:rounded-md  before:transition-opacity before:ease-in before:duration-100 before:bg-emerald-400 after:border-solid after:border-[1px]  after:border-emerald-400 hover:before:opacity-[0.15] active:after:opacity-100 active:before:opacity-25",onClick:e,children:[d(x,{kind:"add",className:"text-2xl mr-1 [line-height:1]"}),"Add new item"]})]})})}function D({label:e,children:t,className:r,invalid:n}){return s("label",{className:b(n&&"before:border-rose-600 before:opacity-70",!n&&"before:opacity-30","relative my-4 flex before:border-2 before:border-emerald-800","before:rounded-lg before:absolute before:inset-0","before:pointer-events-none before:duration-200","before:transition-opacity before:ease-in hover:before:opacity-70","focus-within:before:opacity-100 focus-within:hover:before:opacity-100",r),children:[d("div",{className:"absolute bg-white top-[-10px] left-2 text-sm font-semibold px-1",children:e}),t]})}function ue({boardId:e,boards:t,onChange:r}){return d(D,{label:"Board*",children:d("select",{name:"board",required:!0,value:e,onChange:o=>{const a=Number.parseInt(o.target.value,10);Number.isNaN(a)||r==null||r(a)},className:"w-full outline-none px-4 py-2 [background:none] appearance-none cursor-pointer",children:t.map(o=>d("option",{value:o.id,children:o.name},o.id))})})}function _({length:e,maxLength:t}){return s("div",{className:b("absolute right-0 -bottom-5 text-sm px-1 text-emerald-800","opacity-60 flex",{"text-rose-600 opacity-100":e>t}),children:[d("div",{className:b(e>t&&"animation-pulse"),children:e},e),"/",t]})}function fe({value:e,onBlur:t,onChange:r,innerRef:n,errorMessage:o,maxLength:a,isValid:i}){return s(D,{label:"Description",invalid:!i,className:"mb-8",children:[d("textarea",{name:"title",className:"w-full h-full px-3 py-2 outline-none min-h-[150px]",value:e,onBlur:t,onChange:r,ref:n}),d(_,{length:e.length,maxLength:a}),o&&d("div",{className:"absolute left-0 -bottom-[18px] text-rose-600 px-1 text-sm",children:o})]})}var me=j.forwardRef((e,t)=>d(fe,m(f({},e),{innerRef:t})));function be({type:e="button",onClick:t,children:r,className:n}){return d("button",{type:e,onClick:t,className:b("text-lg pl-4 pr-6 py-1 relative before:pointer-events-none","before:absolute before:inset-0 before:bg-emerald-500","before:rounded-md before:opacity-80 before:transition-opacity","before:duration-200 hover:before:opacity-90 after:absolute","after:pointer-events-none after:inset-0 after:border-2","after:border-emerald-800 after:rounded-md after:opacity-30","after:transition-opacity after:duration-200 hover:after:opacity-40","active:before:opacity-100 focus:before:opacity-80","focus:after:opacity-80 active:after:opacity-100 outline-none","flex font-medium text-white",n),children:d("div",{className:"z-10 flex items-center",children:r})})}function pe({onClose:e}){return s("div",{className:"text-xl font-semibold text-emerald-800 px-4 py-2 bg-emerald-300 rounded-t-xl m-0 flex justify-between items-center",children:[d("h2",{id:"modal-label",children:"Add new item"}),d("button",{className:"flex items-center",onClick:e,children:d(x,{kind:"close",className:"text-4xl"})})]})}function he({type:e="button",onClick:t,children:r,className:n}){return d("button",{type:e,onClick:t,className:b("text-lg px-4 py-1 relative before:pointer-events-none before:absolute","before:inset-0 before:bg-emerald-400 before:rounded-md","before:opacity-0 before:transition-opacity before:duration-200","hover:before:opacity-20 after:absolute after:pointer-events-none","after:inset-0 after:border-2 after:border-emerald-800","after:rounded-md after:opacity-30 after:transition-opacity","after:duration-200 hover:after:opacity-40 active:before:opacity-40","focus:before:opacity-20 font-medium focus:after:opacity-80","active:after:opacity-100 outline-none",n),children:r})}function ye({value:e,onBlur:t,onChange:r,innerRef:n,errorMessage:o,maxLength:a,isValid:i}){return s(D,{label:"Title*",invalid:!i,className:"mb-8",children:[d("input",{name:"title",required:!0,className:"w-full outline-none px-4 py-2 [background:none]",value:e,onBlur:t,onChange:r,ref:n}),d(_,{length:e.length,maxLength:a}),o&&d("div",{className:"absolute left-0 -bottom-[18px] text-rose-600 px-1 text-sm",children:o})]})}var ge=j.forwardRef((e,t)=>d(ye,m(f({},e),{innerRef:t})));function A(e,t){const[r,n]=g.exports.useState(e),[o,a]=g.exports.useState(!0),i=g.exports.useRef(null);return[{value:r,onBlur:p=>{r.length>t&&a(!1)},onChange:p=>{n(p.target.value),p.target.value.length<=t&&a(!0)},ref:i},{isValid:o,errorMessage:o?void 0:"Too many characters",validate:()=>{var p;return r.length>t?(a(!1),(p=i.current)==null||p.focus(),!1):o}}]}const M=50,T=500;function xe({onClose:e,onCreate:t,boards:r,defaultBoardId:n}){const[o,a]=A("",M),[i,l]=g.exports.useState(n),[c,y]=A("",T),p=u=>{u.preventDefault(),a.validate()&&y.validate()&&(t==null||t({boardId:i,description:c.value,title:o.value}))};return s(Q,{isOpen:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,onRequestClose:e,appElement:document.getElementById("root"),aria:{labelledby:"modal-label"},className:{base:"absolute max-w-lg w-full left-[50%] top-[50%] translate-y-[-50%] translate-x-[calc(-50%_-_1rem)] bg-white shadow-xl rounded-xl m-4 w-[calc(100%_-_2rem)]",afterOpen:"",beforeClose:""},children:[d(pe,{onClose:e}),s("form",{onSubmit:p,className:"px-4 py-2",children:[d(ge,m(f(f({},o),a),{maxLength:M})),d(ue,{boardId:i,onChange:l,boards:r}),d(me,m(f(f({},c),y),{maxLength:T})),s("div",{className:"flex justify-end mb-2",children:[d(he,{className:"mr-4",onClick:e,children:"Cancel"}),s(be,{type:"submit",children:[d(x,{kind:"add"})," Add"]})]})]})]})}function ve({initialCards:e,boards:t,persistance:r={}}){const[n,o]=g.exports.useState(()=>R(e.map(u=>[u.id,u]))),[a,i]=g.exports.useState(!1),l=u=>{var h;o(v=>de(v,u)),(h=r.reorder)==null||h.call(r,u)},c=({description:u,title:h,boardId:v})=>{var k;const B=(n.keySeq().max()||0)+1,F=(n.valueSeq().filter(I=>I.boardId===v).map(I=>I.boardId).max()||-1)+1,S={id:B,order:F,title:h,description:u,boardId:v};(k=r.addCard)==null||k.call(r,S),o(n.set(B,S)),i(!1)};return s("div",{className:"text-emerald-800 min-h-screen",children:[d(ce,{onNewItem:()=>i(!0)}),d("main",{className:"max-w-screen-xl m-auto overflow-x-auto",children:d(se,{boards:t,cards:n,onReorder:l,onMove:(u,h)=>{l({cardId:u.id,destination:{boardId:h,order:0},source:{boardId:u.boardId,order:u.order}})},onDelete:u=>{var h;o(v=>v.remove(u)),(h=r.removeCard)==null||h.call(r,u)}})}),a&&d(xe,{boards:t,defaultBoardId:t[0].id,onCreate:c,onClose:()=>i(!1)})]})}const we=R([{id:1,order:0,title:"Welcome",description:"Welcome to the FooBoard web application",boardId:1},{id:2,order:1,title:"Add new card",description:'To add new card just press "Add new item" button at the top-right corner of the page',boardId:1},{id:3,order:2,title:"You don't even need to add descriptions!",description:"",boardId:1},{id:4,order:3,title:"Drag me!",description:"If you feel like you're ready to move to the next stage, just drag this card to the other column. I'm even mobile friendly",boardId:1},{id:5,order:4,title:"Cleaning up",description:"Honestly, all of these cards I've added are pretty useless after you've read them. So why not just delete them completely? Just press on triple dots in the top right corner of this card, to see the optionto delete those pesky cards",boardId:1}].map(e=>[e.id,e])),Ie=[{id:1,name:"To Do"},{id:2,name:"In progress"},{id:3,name:"Done"}],w=U("tasks",1,{upgrade(e){const t=e.createObjectStore("boards",{autoIncrement:!0,keyPath:"id"}),r=e.createObjectStore("cards",{autoIncrement:!0,keyPath:"id"});r.createIndex("toBePatched-boardId-order",["toBePatched","boardId","order"],{unique:!1}),Ie.map(n=>t.put(n)),we.map(n=>r.put(m(f({},n),{toBePatched:0})))}});async function E(){const t=(await w).transaction(["boards","cards"],"readonly",{durability:"relaxed"}),[r,n]=await Promise.all([t.objectStore("boards").getAll(),t.objectStore("cards").getAll(),t.done]);return{boards:r,cards:n}}const Ne=e=>IDBKeyRange.bound([0,e.boardId,e.order],[0,e.boardId+1,0],!0,!0),Ce=e=>IDBKeyRange.bound([0,e.boardId,e.order],[0,e.boardId+1,0],!1,!0),De=IDBKeyRange.lowerBound([1,0,0],!1);async function Be({cardId:e,destination:t,source:r}){const o=(await w).transaction("cards","readwrite"),a=o.objectStore("cards").index("toBePatched-boardId-order");for await(const i of a.iterate(Ne(r))){const{value:l}=i;l.order-=1,i.update(l)}for await(const i of a.iterate(Ce(t))){const{value:l}=i;l.toBePatched=1,i.update(l)}for await(const i of a.iterate(De)){const{value:l}=i;l.toBePatched=0,l.order+=1,i.update(l)}{const i=await o.objectStore("cards").openCursor(e);if(!i)throw new Error("Invalid card id passed");i.update(Object.assign(i.value,t))}await o.done}async function Se(e){await(await w).put("cards",m(f({},e),{toBePatched:0}))}async function ke(e){await(await w).delete("cards",e)}var Pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",retrieveData:E,reorder:Be,addCard:Se,removeCard:ke});(async()=>{const{boards:e,cards:t}=await E();Z.createRoot(document.getElementById("root")).render(d(ve,{boards:e,initialCards:t,persistance:Pe}))})();
